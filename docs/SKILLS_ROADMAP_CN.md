# QueryClaw Skills 路线图

> English version: [SKILLS_ROADMAP.md](SKILLS_ROADMAP.md)

本文档列出 queryclaw 可通过 Skill 系统实现的功能场景，按开发者工作阶段组织，标注各 Skill 的核心价值（传统工具做不到/做不好、而 Agent 能做好的地方）和建议优先级。

---

## 一、开发阶段

### 1. AI 列（AI Column）

> 已有独立设计文档：[DESIGN_AI_COLUMN_CN.md](DESIGN_AI_COLUMN_CN.md)

基于已有表数据，通过 LLM 生成或填充目标列（摘要、分类、翻译、评分、标签等）。突破传统数据库只能用确定性表达式派生列的限制。

### 2. 测试数据工厂（Test Data Factory）

**痛点**：写单元测试/集成测试时，手动造测试数据极其痛苦——要满足外键约束、字段格式、业务规则、数据分布。

**Skill 做什么**：
- 分析表结构、外键、约束，理解表间依赖顺序
- 用 LLM 生成**语义合理**的假数据（不是乱码，而是看起来像真实的名字、地址、订单）
- 按正确的 INSERT 顺序写入（先父表再子表）
- 支持指定数据量和场景（「生成 100 个用户，每人 3~5 个订单，包含一些异常数据」）

**价值**：传统 Faker 库只能随机填充，无法理解业务语义。Agent 能根据 schema 和表名推断出合理数据。

### 3. Schema 文档生成（Schema Documenter）

**痛点**：数据库缺乏文档，新人接手项目不知道表和列的业务含义。

**Skill 做什么**：
- 遍历所有表/列/外键/索引
- LLM 根据命名和数据采样，推断业务含义
- 生成 Markdown 格式的 schema 文档（含表说明、列说明、ER 关系描述）
- 可写入数据库的 `COMMENT` 字段

**价值**：传统工具只能导出结构，无法推断含义。LLM 能从 `order_status`、`created_at` 这样的命名中理解并描述业务含义。

### 4. API 脚手架（API Scaffolding）

**痛点**：每张表都要手写 CRUD 接口，重复劳动。

**Skill 做什么**：
- 读取表结构，理解字段类型和关系
- 生成目标框架（FastAPI / Express / Spring Boot 等）的 CRUD 代码
- 包含参数校验、分页、排序、关联查询

**价值**：比传统 codegen 更智能——能根据业务语义决定哪些字段可写、哪些只读、如何做搜索过滤。

---

## 二、排查与调试

### 5. 数据侦探（Data Detective）

**痛点**：线上出 bug，需要快速定位「这条数据为什么不对」。

**Skill 做什么**：
- 用户描述问题（「用户 ID 12345 的订单状态不对」）
- Agent 自动追踪关联表：`users → orders → payments → refunds`
- 拼出完整数据链路，找到异常点
- 用自然语言解释问题成因

**价值**：开发者通常需要手动写多个 JOIN 查询才能追踪数据流。Agent 自动沿着外键探索，就像一个会查数据库的侦探。

### 6. 查询翻译器（Query Translator）

**痛点**：看到一条复杂的 SQL（几十行 JOIN + 子查询 + 窗口函数），不知道它在干什么。

**Skill 做什么**：
- 输入一条 SQL，输出自然语言解释（逐步分解）
- 指出潜在问题（缺索引、笛卡尔积、N+1）
- 建议优化写法

**价值**：传统工具只能做 EXPLAIN，不能「解释」。LLM 能把 SQL 翻译成人话。

---

## 三、数据质量与治理

### 7. 数据修复师（Data Healer）

**痛点**：数据库里总有脏数据——孤岛记录、格式不一致、违反业务规则的值。

**Skill 做什么**：
- 扫描外键完整性（找孤岛记录）
- 检查格式一致性（手机号、邮箱、日期格式）
- 用 LLM 识别语义错误（如城市名拼写不一致：「北京」vs「Beijing」vs「BeiJing」）
- 提出修复方案并执行（经人工确认）

**价值**：传统 SQL 只能做规则检查，无法做语义层面的脏数据识别。

### 8. 数据脱敏（Data Masker）

**痛点**：开发/测试环境需要真实结构但脱敏的数据。

**Skill 做什么**：
- 自动识别 PII 列（LLM 根据列名和采样推断：姓名、手机、身份证、邮箱、地址...）
- 生成**语义合理**的替代数据（不是 `***`，而是另一个看起来真实的假名字/假地址）
- 保持数据间的关联一致性（同一个人的名字在多张表中保持一致）

**价值**：传统脱敏工具需要人工标记哪些列是敏感的。Agent 自动识别。

### 9. 异常探测器（Anomaly Scanner）

**痛点**：数据里有没有异常值、统计偏差、可疑模式？人工很难发现。

**Skill 做什么**：
- 对数值列做分布分析（均值、标准差、离群值）
- 对分类列做频率分析（找出极低频的异常值）
- 对时序数据做趋势检测（突增、突降、缺失段）
- LLM 综合分析，给出可能的业务解释

**价值**：传统 BI 工具需要人先知道要看什么。Agent 主动扫描发现你不知道的问题。

---

## 四、性能与运维

### 10. 索引顾问（Index Advisor）

**痛点**：哪些查询慢？该加什么索引？加了会不会影响写入？

**Skill 做什么**：
- 分析慢查询日志 / `SHOW PROCESSLIST`
- 对慢查询做 EXPLAIN，分析全表扫描、文件排序等
- 建议索引（含复合索引的列顺序）
- 评估索引对写入性能的影响
- 生成 `CREATE INDEX` 语句（经确认后执行）

### 11. 变更影响分析（Change Impact Analyzer）

**痛点**：改表结构前，不知道会影响哪些查询、哪些应用。

**Skill 做什么**：
- 用户说「我想把 users.email 改为 NOT NULL」
- Agent 分析：当前有多少 NULL 值？有哪些外键依赖？
- 评估影响范围
- 生成安全的迁移方案（先填充、再加约束）

### 12. 容量规划师（Capacity Planner）

**痛点**：表还能撑多久？按现在的增长速度什么时候要扩容？

**Skill 做什么**：
- 统计各表行数、数据量、增长速率
- 分析索引大小占比
- 预测未来 N 天/月的存储需求
- 建议分区、归档或清理策略

---

## 五、合规与安全

### 13. 合规扫描器（Compliance Scanner）

**痛点**：数据库是否符合 GDPR / 等保 / PCI-DSS 等合规要求？

**Skill 做什么**：
- 扫描所有列，识别可能存储 PII 的列（LLM 语义推断）
- 检查是否有明文存储密码、信用卡号
- 检查访问权限是否符合最小权限原则
- 生成合规报告和整改建议

### 14. 权限审计（Permission Auditor）

**痛点**：数据库用户权限混乱，不知道谁有什么权限。

**Skill 做什么**：
- 列出所有用户/角色及其权限
- 识别过度授权（如普通应用用户有 DROP 权限）
- 建议权限收紧方案
- 生成 `REVOKE` / `GRANT` 语句

---

## 六、数据迁移与演进

### 15. 智能迁移器（Smart Migrator）

**痛点**：schema 升级的迁移脚本写起来复杂，怕出错。

**Skill 做什么**：
- 用户描述期望的 schema 变更（自然语言）
- Agent 分析当前 schema，生成 DDL 迁移脚本
- 自动生成回滚脚本
- dry-run 预览影响（行数、锁表时间估计）
- 按顺序执行（经确认）

### 16. 跨库同步检查（Cross-DB Sync Checker）

**痛点**：多套环境（开发/测试/生产）的 schema 或数据不一致。

**Skill 做什么**（需多数据库连接支持）：
- 比较两个库的 schema 差异
- 比较关键表的数据差异（行数、校验和）
- 生成同步脚本

---

## 优先级总览

| 优先级 | Skill | 建议阶段 | 核心价值 |
|--------|-------|---------|---------|
| **高** | AI 列 | 阶段二 | 核心差异化功能，传统工具无法实现 |
| **高** | 测试数据工厂 | 阶段二 | 开发者高频刚需 |
| **高** | 数据侦探 | 阶段二 | 排查调试利器 |
| **高** | Schema 文档生成 | 阶段二 | 上手项目必备 |
| 中 | 查询翻译器 | 阶段二 | 低成本高价值 |
| 中 | 索引顾问 | 阶段三 | DBA 级能力下放 |
| 中 | 数据修复师 | 阶段三 | 数据治理核心 |
| 中 | 异常探测器 | 阶段三 | 主动发现问题 |
| 中 | 数据脱敏 | 阶段三 | 安全合规 |
| 中 | 智能迁移器 | 阶段三 | 运维场景 |
| 低 | 变更影响分析 | 阶段三 | 进阶运维 |
| 低 | 容量规划师 | 阶段四 | DBA 场景 |
| 低 | 合规扫描器 | 阶段四 | 企业场景 |
| 低 | 权限审计 | 阶段四 | 企业场景 |
| 低 | API 脚手架 | 阶段四 | 开发提效 |
| 低 | 跨库同步检查 | 阶段四+ | 多库支持后 |

---

所有 Skill 的共同特点：**它们都利用 LLM 的语义理解能力来做传统数据库工具做不到的事**。这也是 queryclaw 作为「AI 原生数据库 Agent」的核心差异化所在。
